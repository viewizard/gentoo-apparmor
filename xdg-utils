# ------------------------------------------------------------------
#
#    Copyright (C) 2016 Mikhail Kurinnoi
#
#    This program is free software; you can redistribute it and/or
#    modify it under the terms of version 2 of the GNU General Public
#    License published by the Free Software Foundation.
#
# ------------------------------------------------------------------

#include <tunables/global>
profile xdg-open /usr/bin/xdg-open {
  #include <abstractions/base>
  #include <abstractions/dbus>
  #include <abstractions/dbus-session>
  #include <abstractions/freedesktop.org>
  #include <abstractions/nameservice>


  /dev/tty rw,
  owner @{PROC}/@{pid}/fd/ r,

  /bin/bash r,
  /usr/bin/xdg-open r,
  /usr/bin/exo-open Px,
  /usr/bin/dbus-send ix,
  /usr/bin/xprop ix,
  /bin/grep ix,
  
}

profile xdg-email /usr/bin/xdg-email {
  #include <abstractions/base>

  /dev/tty rw,

  /bin/bash r,
  /usr/bin/xdg-email r,
  /bin/sed ix,
  /usr/bin/which ix,
  /usr/bin/exo-open Px,
  
}

profile xdg-screensaver /usr/bin/xdg-screensaver {
  #include <abstractions/base>
  #include <abstractions/dbus-session>
  #include <abstractions/X>

  /dev/tty rw,

  /usr/bin/xdg-screensaver r,
  /bin/bash r,
  /bin/grep ix,
  /bin/mv ix,
  /bin/sed ix,
  /usr/bin/which ix,
  /bin/hostname ix,
  /usr/bin/dbus-send ix,
  /usr/bin/xset ix,
  /usr/bin/xautolock Px,
  
}
