# ------------------------------------------------------------------
#
#  Copyright (C) 2016,2017 Mikhail Kurinnoi
#
#  This program is free software; you can redistribute it and/or
#  modify it under the terms of version 2 of the GNU General Public
#  License published by the Free Software Foundation.
#
# ------------------------------------------------------------------

#include <tunables/global>

profile lsb-release /usr/bin/lsb_release {
  #include <abstractions/base>
  #include <abstractions/python>
  
  # PSEUDO ---------------------------------------------
  /dev/tty						rw,
  /dev/pts/[0-9]*					w,
  
  # EXECUTABLES ----------------------------------------
  /usr/bin/lsb_release					r,
  @{shell}						mr,
  /bin/sed						ixr,
  /bin/head						ixr,
  /bin/tr						ixr,
  /usr/bin/find						ix,
  /bin/basename						ix,
  /usr/bin/getopt					ixr,
  /usr/bin/dpkg-query					ixr,
  
  # READS/WRITES ---------------------------------------
  /etc/							r,
  /etc/{gentoo,os,lsb}-release				r,
  /usr/bin/						r,
  /var/lib/dpkg/**					r,
  
  # NOISY ----------------------------------------------
  deny /etc/apparmor.d/					r,
  deny /home/**						r,
}
