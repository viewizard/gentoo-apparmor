# ------------------------------------------------------------------
#
#  Copyright (C) 2016,2017 Mikhail Kurinnoi
#
#  This program is free software; you can redistribute it and/or
#  modify it under the terms of version 2 of the GNU General Public
#  License published by the Free Software Foundation.
#
# ------------------------------------------------------------------

#include <tunables/global>

profile lsb-release /usr/bin/lsb_release {
  #include <abstractions/base>
  
  # PSEUDO ---------------------------------------------
  /dev/tty						rw,
  /dev/tty[0-9]*					rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /usr/bin/lsb_release					r,
  @{shell}						mr,
  /bin/sed						ixr,
  /bin/head						ixr,
  /bin/tr						Pxr,
  /usr/bin/find						ix,
  /usr/bin/getopt					ixr,
  
  # READS/WRITES ---------------------------------------
  /etc/							r,
  /etc/{gentoo,os,lsb}-release				r,
  
  # NOISY ----------------------------------------------
  deny /etc/apparmor.d/					r,
  deny /opt/discord/share/discord/			r,
  deny /usr/share/inkscape/extensions/			r,
  deny /opt/teamspeak3-client/				r,
  deny /run/user/[0-9]*/poedit.*			rw,
  deny /home/**						r,
}
