# ------------------------------------------------------------------
#
#  Copyright (C) 2016,2017 Mikhail Kurinnoi
#
#  This program is free software; you can redistribute it and/or
#  modify it under the terms of version 2 of the GNU General Public
#  License published by the Free Software Foundation.
#
# ------------------------------------------------------------------

#include <tunables/global>

profile lsb-release /usr/bin/lsb_release flags=(attach_disconnected) {
  #include <abstractions/base>
  
  # PSEUDO ---------------------------------------------
  /dev/tty						rw,
  /dev/tty[0-9]*					rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /usr/bin/lsb_release					r,
  @{shell}						mr,
  /bin/sed						ixr,
  /bin/head						ixr,
  /bin/tr						Pxr,
  /usr/bin/find						ix,
  /usr/bin/getopt					ixr,
  
  # READS/WRITES ---------------------------------------
  /etc/							r,
  /etc/{gentoo,os,lsb}-release				r,
  
  # DENY INHERIT ---------------------------------------
  deny unix (send, receive) peer=(label="discord"),		# discord
  deny /apparmor/.null					r,	# flags=(attach_disconnected)
  deny /etc/apparmor.d/					r,	# apparmor
  deny /opt/discord/share/discord/{,**}			r,	# discord
  deny /usr/share/inkscape/extensions/			r,	# inkscape
  deny /opt/teamspeak3-client/				r,	# teamspeak-client-bin.teamspeak
  deny /run/user/[0-9]*/poedit.*			rw,	# poedit
  deny /home/**						r,
}
