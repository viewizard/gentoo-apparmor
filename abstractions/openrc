# ------------------------------------------------------------------
#
#  Copyright (C) 2016,2017 Mikhail Kurinnoi
#
#  This program is free software; you can redistribute it and/or
#  modify it under the terms of version 2 of the GNU General Public
#  License published by the Free Software Foundation.
#
# ------------------------------------------------------------------

#include <abstractions/ncurses>

# CAPABILITIES -----------------------------------------
capability kill,
capability sys_ptrace,
capability dac_override,
capability sys_tty_config,

# PTRACE -----------------------------------------------
ptrace (trace),

# SIGNAL -----------------------------------------------
signal (send) set=(term, hup),

# PSEUDO -----------------------------------------------
/dev/tty						rw,
audit /dev/ptmx						rw,	# FIX ME! audit 16.06.2017
/dev/console						rw,
/dev/pts/[0-9]*						rw,
/sys/fs/cgroup/						r,
/sys/fs/cgroup/*/tasks					w,
@{PROC}/						r,
@{PROC}/cmdline						r,
@{PROC}/@{pid}/environ					r,
@{PROC}/@{pid}/stat					r,
owner @{PROC}/@{pid}/cmdline				r,

# EXECUTABLES ------------------------------------------
/sbin/openrc-run					mr,
audit /sbin/openrc					Px,	# FIX ME! audit 16.06.2017
/sbin/start-stop-daemon					ix,	# openrc-run.sh и start-stop-daemon запускаем в профиле
/lib{,32,64}/rc/sh/openrc-run.sh			ix,	# скрипта, чтобы все уникальные части были в скрипте пакета.
/lib{,32,64}/rc/bin/*					ix,	# FIX ME! (?) Вынести в отдельный профиль.

# READS/WRITES -----------------------------------------
/etc/rc.conf						r,
/etc/profile.env					r,
/etc/{conf,init}.d/					r,
/run/openrc/**						rwk,
