# ------------------------------------------------------------------
#
#    Copyright (C) 2016 Mikhail Kurinnoi
#
#    This program is free software; you can redistribute it and/or
#    modify it under the terms of version 2 of the GNU General Public
#    License published by the Free Software Foundation.
#
# ------------------------------------------------------------------

#include <tunables/global>
profile xfce4-panel /usr/bin/xfce4-panel {
  #include <abstractions/base>
  #include <abstractions/freedesktop.org>
  #include <abstractions/fonts>
  #include <abstractions/gtk>
  #include <abstractions/nvidia>
  #include <abstractions/X>
  #include <abstractions/nameservice>
  #include <abstractions/executable-binary-programs>
  #include <local/xfce4-panel-custom>
  
  /dev/tty[0-9]* w,
  @{PROC}/@{pid}/fd/ r,
  
  /usr/bin/xfce4-panel r,
  /usr/lib64/xfce4/panel/wrapper-[1-2].0 Px,
  /usr/lib64/xfce4/panel-plugins/xfce4-*-plugin Px,
  
  /etc/xdg/menus/**.menu r,
  /etc/xdg/menus/applications-merged/ r,
  /usr/share/xfce4/panel/plugins/{,*.desktop} r,
  /usr/share/xfce4/panel-plugins/{,*.desktop} r,
  owner @{HOME}/.config/xfce4/panel/{,*.rc*} rw,
  owner @{HOME}/.config/xfce4/panel/launcher-**.desktop r,
  owner @{HOME}/.config/menus/**.menu rw,
  owner @{HOME}/.config/menus/applications-merged/ r,
  
}


profile xfce4-panel.wrapper-1.0 /usr/lib64/xfce4/panel/wrapper-1.0 {
  #include <abstractions/base>
  #include <abstractions/freedesktop.org>
  #include <abstractions/fonts>
  #include <abstractions/X>
  #include <abstractions/gtk>
  #include <abstractions/nameservice>
  #include <abstractions/executable-binary-programs>
  #include <local/xfce4-panel-custom>
  
  /dev/tty[0-9]* w,
  @{PROC}/@{pid}/fd/ r,
  
  /usr/bin/xfce4-session-logout Px,
  /bin/env Cx -> env,
  /usr/bin/xflock4 Px,
  /usr/bin/passwd.sh Px,
  
  /usr/share/alacarte/* r,
  /etc/xdg/menus/**.menu r,
  /etc/xdg/menus/applications-merged/ r,
  /usr/share/desktop-directories/{,*.directory} r,
  /opt/**.png r,
  
  /usr/share/xfce4/weather/icons/**.{info,png} r,
  /usr/share/xfce4-notes-plugin/** r,
  
  owner @{HOME}/.face r,
  owner @{HOME}/@{XDG_DESKTOP_DIR}/*.desktop rw,
  owner @{HOME}/.config/menus/**.menu rw,
  owner @{HOME}/.config/menus/applications-merged/ r,
  owner @{HOME}/.config/xfce4/panel/{,**} rw,
  owner @{HOME}/.config/xfce4/xfce4-notes.gtkrc* rw,
  owner @{HOME_CACHE}/xfce4/ rw,
  owner @{HOME_CACHE}/xfce4/clipman/{,*} rw,
  owner @{HOME_CACHE}/xfce4/weather/{,*} rw,
  owner @{HOME}/.local/share/applications/**.desktop rw,
  owner @{HOME}/.local/share/desktop-directories/{,*.directory} r,
  owner @{HOME}/.local/share/notes/{,**} rw,
  
  
  profile env {
    #include <abstractions/base>
    
    /dev/tty[0-9]* w,
    /dev/pts/[0-9]* rw,
    
    /bin/env r,
    /usr/bin/wine Px,
    
  }
  
}


profile xfce4-panel.wrapper-2.0 /usr/lib64/xfce4/panel/wrapper-2.0 {
  #include <abstractions/base>
  #include <abstractions/freedesktop.org>
  #include <abstractions/fonts>
  #include <abstractions/X>
  #include <abstractions/gtk>
  #include <abstractions/audio>
  #include <abstractions/dbus-session>
  #include <abstractions/executable-binary-programs>
  
  @{PROC}/@{pid}/fd/ r,
  
  /usr/bin/pulseaudio Px,
  /usr/bin/pavucontrol Px,
  
}


profile xfce4-panel.xfce4-xkb-plugin /usr/lib64/xfce4/panel-plugins/xfce4-xkb-plugin {
  #include <abstractions/base>
  #include <abstractions/freedesktop.org>
  #include <abstractions/fonts>
  #include <abstractions/X>
  #include <abstractions/gtk>
  
  /usr/share/xfce4/xkb/flags/*.svg r,
  
  owner @{HOME}/.config/xfce4/panel/{,*.rc*} rw,
  
}


profile xfce4-panel.xfce4-kbdleds-plugin /usr/lib64/xfce4/panel-plugins/xfce4-kbdleds-plugin {
  #include <abstractions/base>
  #include <abstractions/freedesktop.org>
  #include <abstractions/fonts>
  #include <abstractions/X>
  #include <abstractions/gtk>
  
  owner @{HOME}/.config/xfce4/panel/{,*.rc*} rw,
  
}


profile xfce4-panel.xfce4-sensors-plugin /usr/lib64/xfce4/panel-plugins/xfce4-sensors-plugin {
  #include <abstractions/base>
  #include <abstractions/freedesktop.org>
  #include <abstractions/fonts>
  #include <abstractions/X>
  #include <abstractions/gtk>
  
  /sys/class/hwmon/ r,
  /sys/class/i2c-adapter/ r,
  /sys/class/power_supply/ r,
  /sys/class/thermal/ r,
  /sys/devices/pci**/i2c-*/name r,
  /sys/devices/platform/*/{,**} r,
  /sys/module/acpi/parameters/acpica_version r,
  
  /etc/sensors3.conf r,
  /etc/sensors.d/ r,
  
  owner @{HOME}/.config/xfce4/panel/{,*.rc*} rw,
  
}
