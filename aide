# ------------------------------------------------------------------
#
#    Copyright (C) 2016 Mikhail Kurinnoi
#
#    This program is free software; you can redistribute it and/or
#    modify it under the terms of version 2 of the GNU General Public
#    License published by the Free Software Foundation.
#
# ------------------------------------------------------------------

#include <tunables/global>
profile aide /usr/bin/aide {
  #include <abstractions/base>
  #include <abstractions/user-tmp>
  
  capability dac_read_search,
  capability dac_override,
  
  /dev/pts/[0-9]* rw,
  
  /usr/bin/aide mr,
  
  / r,
  /** r,
  
  /var/lib/aide/** rwk,
  
}


profile aide.aideinit /usr/sbin/aideinit {
  #include <abstractions/base>
  
  capability dac_read_search,
  
  /dev/tty rw,
  /dev/pts/[0-9]* rw,
  
  /bin/bash mr,
  /usr/sbin/aideinit r,
  /bin/cut ix,
  /bin/grep ix,
  /bin/egrep ixr,
  /bin/cp ix,
  /usr/bin/aide Px,
  
  /etc/aide/** r,
  /var/lib/aide/** rwk,
  
}
