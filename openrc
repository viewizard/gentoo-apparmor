# ------------------------------------------------------------------
#
#  Copyright (C) 2016-2018 Mikhail Kurinnoi
#
#  This program is free software; you can redistribute it and/or
#  modify it under the terms of version 2 of the GNU General Public
#  License published by the Free Software Foundation.
#
# ------------------------------------------------------------------

#include <local/tunables.d/>

profile openrc@{p_root} /sbin/openrc@{t_root} flags=(attach_disconnected,complain) {	# attach_disconnected, name="" comm="openrc"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/ncurses>
  
  # CAPABILITIES ---------------------------------------
  capability sys_ptrace,
  capability sys_tty_config,
  capability dac_override,
  capability kill,
  
  # PTRACE ---------------------------------------------
  ptrace (trace),
  
  # PSEUDO ---------------------------------------------
  /dev/tty						rw,
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/ptmx						rw,
  /dev/pts/[0-9]*					rw,
  @{SYS_D}/fs/cgroup/					r,
  @{SYS_D}/fs/cgroup/**					rw,
  @{SYS_D}/fs/cgroup/{,**/}*				k,
  @{PROC_D}/						r,
  @{PROC_D}/cmdline					r,
  @{PROC_D}/@{pids}/cmdline				r,
  owner @{PROC_D}/1/environ				r,
  audit @{PROC_D}/@{pid}/stat				r,	# FIX ME! @{pid}/@{pids} audit 19.10.2017
  audit @{PROC_D}/@{pid}/mounts				r,	# FIX ME! @{pid}/@{pids} audit 19.10.2017
  
  # EXECUTABLES ----------------------------------------
  /sbin/openrc						mr,
  @{shell}@{t_root}					Cx,
  /lib{,32,64}/rc/sh/init-early.sh@{t_root}		Px,
  /lib{,32,64}/rc/sh/init.sh@{t_root}			Px,
  # All scripts from ALL runlevels must have profiles!
  /etc/init.d/*@{t_root}				Px,
  
  # READS/WRITES ---------------------------------------
  /etc/conf.d/*						r,
  /etc/rc.conf						r,
  /etc/profile.env					r,
  /etc/fstab						r,
  /etc/{conf,init}.d/					r,
  /etc/runlevels/{,**}					rw,
  /var/log/rc.log					w,
  /run/**{,.}pid					rw,
  /run/openrc/**					rw,
  /run/openrc/{,**/}*					k,
  
  profile shell @{shell}@{t_root} flags=(complain) {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
    
    # CAPABILITIES -------------------------------------
    capability sys_tty_config,
    capability dac_override,
    capability dac_read_search,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
  }
}

profile openrc.openrc-init@{p_root} /sbin/openrc-init@{t_root} flags=(complain) {
  #include <abstractions/base>
  
  # EXECUTABLES ----------------------------------------
  /sbin/openrc-init					mr,
  /sbin/openrc@{t_root}					Px,
}

profile openrc.openrc-shutdown@{p_root} /sbin/openrc-shutdown@{t_root} flags=(complain) {
  #include <abstractions/base>
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /sbin/openrc-shutdown					mr,
  
  # READS/WRITES ---------------------------------------
  /var/log/wtmp						wk,
}

profile openrc.rc-service@{p_root} /sbin/rc-service@{t_root} flags=(complain) {
  #include <abstractions/base>
  
  # EXECUTABLES ----------------------------------------
  /sbin/rc-service					mr,
  /etc/init.d/*@{t_root}				Px,
  
  # READS/WRITES ---------------------------------------
  /run/openrc/scheduled/				rw,
}

profile openrc.rc-update@{p_root} /sbin/rc-update@{t_root} flags=(complain) {
  #include <abstractions/base>
  #include <abstractions/ncurses>
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /sbin/rc-update					mr,
  
  # READS/WRITES ---------------------------------------
  /etc/init.d/						r,
  /etc/runlevels/{,**}					rw,
  /run/openrc/**					rw,
}

profile openrc.rc-status@{p_root} /bin/rc-status@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="rc-status"
  #include <abstractions/base>
  #include <abstractions/ncurses>
  
  # CAPABILITIES ---------------------------------------
  capability kill,
  capability sys_ptrace,
  capability dac_read_search,
  capability dac_override,
  
  # PTRACE ---------------------------------------------
  ptrace (trace),
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/pts/[0-9]*					rw,
  @{PROC_D}/						r,
  @{PROC_D}/cmdline					r,
  @{PROC_D}/@{pids}/cmdline				r,
  audit @{PROC_D}/@{pid}/environ			r,	# FIX ME! @{pid}/@{pids} audit 19.10.2017
  
  # EXECUTABLES ----------------------------------------
  /bin/rc-status					mr,
  @{shell}@{t_root}					Cx,
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/					r,
  /etc/rc.conf						r,
  /etc/runlevels/{,**}					r,
  /run/openrc/**					r,
  /run/openrc/depconfig					w,
  /run/openrc/deptree					w,
  /run/{*.,*/,*/*.}pid					r,
  
  profile shell @{shell}@{t_root} flags=(complain) {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
}

profile openrc.gendepends.sh@{p_root} /lib{,32,64}/rc/sh/gendepends.sh@{t_root} flags=(attach_disconnected,complain) {
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/ncurses>
  
  # CAPABILITIES ---------------------------------------
  capability sys_tty_config,
  capability dac_override,
  capability dac_read_search,
  
  # PSEUDO ---------------------------------------------
  /dev/tty						rw,
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/sh/gendepends.sh			r,
  @{shell}						mr,
  /bin/sed@{t_root}					Cx,	# sys-apps/sed
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /sbin/openrc@{t_root}					Px,
  /sbin/lvm@{t_root}					Px,	# sys-fs/lvm2
  /usr/bin/gawk@{t_root}				Cx,	# sys-apps/gawk
  /lib{,32,64}/rc/bin/shell_var@{t_root}		Px,
  /lib{,32,64}/rc/bin/service_started@{t_root}		Px,
  /lib{,32,64}/rc/bin/service_get_value@{t_root}	Px,
  /lib{,32,64}/rc/bin/fstabinfo@{t_root}		Px,
  /lib{,32,64}/rc/bin/eval_ecolors@{t_root}		Px,
  
  # READS/WRITES ---------------------------------------
  /etc/rc.conf						r,
  /etc/exports.d/{,*}					r,	# net-fs/nfs-utils
  /etc/{conf,init}.d/{,*}				r,
  /usr/libexec/rc.apparmor.functions			r,	# sys-apps/apparmor
  
  # DENY INHERIT ---------------------------------------
  deny /apparmor/.null					rw,	# flags=(attach_disconnected)
  
  profile sed /bin/sed@{t_root} flags=(complain) {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/sed						mr,
  }
  
  profile grep /bin/grep@{t_root} flags=(attach_disconnected,complain) {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
    
    # READS/WRITES -------------------------------------
    /etc/fstab						r,
    /etc/{conf,init}.d/{,*}				r,
    
    # DENY INHERIT -------------------------------------
    deny /apparmor/.null				rw,	# flags=(attach_disconnected)
  }
  
  profile gawk /usr/bin/gawk@{t_root} flags=(complain) {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability mknod,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /usr/bin/gawk					mr,
    
    # READS/WRITES -------------------------------------
    /etc/exports					r,	# net-fs/nfs-utils
    /etc/ssh/sshd_config				r,	# net-misc/openssh
  }
}

profile openrc.init-early.sh@{p_root} /lib{,32,64}/rc/sh/init-early.sh@{t_root} flags=(complain) {
  #include <abstractions/base>
  #include <abstractions/nameservice>
  
  # PSEUDO ---------------------------------------------
  /dev/tty						rw,
  /dev/tty[0-9]*					rw,
  /dev/pts/[0-9]*					rw,
  /dev/null						w,
  /dev/console						rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/sh/init-early.sh			r,
  @{shell}						mr,
  /usr/bin/setfont@{t_root}				Px,	# sys-apps/kbd
  /usr/bin/loadkeys@{t_root}				Px,	# sys-apps/kbd
  /usr/bin/kbd_mode@{t_root}				Px,	# sys-apps/kbd
}

profile openrc.init.sh@{p_root} /lib{,32,64}/rc/sh/init.sh@{t_root} flags=(complain) {
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/ncurses>
  
  # CAPABILITIES ---------------------------------------
  capability mknod,
  
  # PSEUDO ---------------------------------------------
  /dev/tty						rw,
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/sh/init.sh				r,
  @{shell}						mr,
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/cp@{t_root}					Cx,	# sys-apps/coreutils
  /sbin/openrc@{t_root}					Px,
  /usr/bin/md5sum@{t_root}				Cx,	# sys-apps/coreutils
  /lib{,32,64}/rc/bin/checkpath@{t_root}		Px,
  /lib{,32,64}/rc/bin/eval_ecolors@{t_root}		Px,
  /lib{,32,64}/rc/bin/einfo@{t_root}			Px,
  /lib{,32,64}/rc/bin/mountinfo@{t_root}		Px,
  
  # READS/WRITES ---------------------------------------
  /etc/rc.conf						r,
  /run/openrc/softlevel					w,
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile cp /bin/cp@{t_root} flags=(complain) {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability sys_admin,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/cp						mr,
    
    # READS/WRITES -------------------------------------
    /run/openrc/{,*}					w,
  }
  
  profile md5sum /usr/bin/md5sum@{t_root} flags=(complain) {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    owner @{PROC_D}/@{pid}/environ			r,
    
    # EXECUTABLES --------------------------------------
    /usr/bin/md5sum					mr,
  }
}

profile openrc.cgroup-release-agent.sh@{p_root} /lib{,32,64}/rc/sh/cgroup-release-agent.sh@{t_root} {
  #include <abstractions/base>
  #include <abstractions/nameservice>
  
  # CAPABILITIES ---------------------------------------
  capability mknod,
  
  # PSEUDO ---------------------------------------------
  /dev/tty						rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/sh/cgroup-release-agent.sh		r,
  @{shell}						mr,
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES ---------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    @{SYS_D}/fs/cgroup/openrc/**			w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.kill_all@{p_root} /lib{,32,64}/rc/bin/kill_all@{t_root} flags=(complain) {
  #include <abstractions/base>
  #include <abstractions/ncurses>
  
  # CAPABILITIES ---------------------------------------
  capability kill,
  
  # SIGNAL ---------------------------------------------
  signal (send),						# Все правильно, должны иметь возможность передать
  								# любой сигнал любому процессу.
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  @{PROC_D}/						r,
  @{PROC_D}/@{pids}/status				r,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/bin/kill_all				mr,
}

profile openrc.checkpath@{p_root} /lib{,32,64}/rc/bin/checkpath@{t_root} flags=(complain) {
  #include <abstractions/base>
  #include <abstractions/ncurses>
  #include <abstractions/nameservice>
  
  # CAPABILITIES ---------------------------------------
  capability chown,
  capability fsetid,
  capability dac_override,
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/bin/checkpath				mr,
  
  # READS/WRITES ---------------------------------------
  /run/openrc/						w,	# DELEGATION! openrc.init.sh
  /run/lock/						w,	# DELEGATION! openrc.init.sh
}

profile openrc.mountinfo@{p_root} /lib{,32,64}/rc/bin/mountinfo@{t_root} flags=(complain) {
  #include <abstractions/base>
  
  # CAPABILITIES ---------------------------------------
  capability dac_override,
  capability dac_read_search,
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  @{PROC_D}/cgroups					r,
  owner @{PROC_D}/@{pid}/mounts				r,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/bin/mountinfo				mr,
  
  # READS/WRITES ---------------------------------------
  /etc/fstab						r,
}

profile openrc.fstabinfo@{p_root} /lib{,32,64}/rc/bin/fstabinfo@{t_root} flags=(attach_disconnected,complain) {
  #include <abstractions/base>
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/bin/fstabinfo				mr,
  
  # READS/WRITES ---------------------------------------
  /etc/fstab						r,
  
  # DENY INHERIT ---------------------------------------
  deny /apparmor/.null					rw,	# flags=(attach_disconnected)
}

profile openrc.eval_ecolors@{p_root} /lib{,32,64}/rc/bin/eval_ecolors@{t_root} flags=(complain) {
  #include <abstractions/base>
  #include <abstractions/ncurses>
  
  # CAPABILITIES ---------------------------------------
  capability sys_tty_config,
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/bin/eval_ecolors			mr,
}

profile openrc.ebegin@{p_root} /lib{,32,64}/rc/bin/ebegin@{t_root} flags=(attach_disconnected,complain) {
  #include <abstractions/base>
  #include <abstractions/ncurses>
  
  # CAPABILITIES ---------------------------------------
  capability sys_tty_config,
  capability mknod,
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/bin/ebegin				mr,
  
  # DENY INHERIT ---------------------------------------
  deny /apparmor/.null					rw,	# flags=(attach_disconnected)
  deny /etc/conf.d/dmcrypt				r,	# sys-fs/cryptsetup
}

profile openrc.eend@{p_root} /lib{,32,64}/rc/bin/eend@{t_root} flags=(attach_disconnected,complain) {
  #include <abstractions/base>
  #include <abstractions/ncurses>
  
  # CAPABILITIES ---------------------------------------
  capability sys_tty_config,
  capability mknod,
  
  # PSEUDO ---------------------------------------------
  /dev/tty						rw,
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/bin/eend				mr,
  
  # DENY INHERIT ---------------------------------------
  deny /apparmor/.null					rw,	# flags=(attach_disconnected)
  deny /etc/conf.d/dmcrypt				r,	# sys-fs/cryptsetup
}

profile openrc.ewend@{p_root} /lib{,32,64}/rc/bin/ewend@{t_root} flags=(complain) {
  #include <abstractions/base>
  #include <abstractions/ncurses>
  
  # CAPABILITIES ---------------------------------------
  capability mknod,
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/bin/ewend				mr,
}

profile openrc.shell_var@{p_root} /lib{,32,64}/rc/bin/shell_var@{t_root} flags=(attach_disconnected,complain) {
  #include <abstractions/base>
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/bin/shell_var				mr,
  
  # DENY INHERIT ---------------------------------------
  deny /apparmor/.null					rw,	# flags=(attach_disconnected)
}

profile openrc.einfo@{p_root} /lib{,32,64}/rc/bin/einfo{,n}@{t_root} flags=(attach_disconnected,complain) {
  #include <abstractions/base>
  #include <abstractions/ncurses>
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/bin/einfo{,n}				mr,
  
  # DENY INHERIT ---------------------------------------
  deny /apparmor/.null					rw,	# flags=(attach_disconnected)
  deny /etc/conf.d/dmcrypt				r,	# sys-fs/cryptsetup
}

profile openrc.ewarn@{p_root} /lib{,32,64}/rc/bin/ewarn{,n}@{t_root} flags=(attach_disconnected,complain) {
  #include <abstractions/base>
  #include <abstractions/ncurses>
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/bin/ewarn{,n}				mr,
  
  # DENY INHERIT ---------------------------------------
  deny /apparmor/.null					rw,	# flags=(attach_disconnected)
}

profile openrc.eerror@{p_root} /lib{,32,64}/rc/bin/eerror{,n}@{t_root} flags=(attach_disconnected,complain) {
  #include <abstractions/base>
  #include <abstractions/ncurses>
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/bin/eerror{,n}				mr,
  
  # DENY INHERIT ---------------------------------------
  deny /apparmor/.null					rw,	# flags=(attach_disconnected)
}

profile openrc.service@{p_root} /lib{,32,64}/rc/bin/service_*@{t_root} flags=(attach_disconnected,complain) {
  #include <abstractions/base>
  
  # CAPABILITIES ---------------------------------------
  capability kill,
  capability sys_ptrace,
  
  # PTRACE ---------------------------------------------
  ptrace (trace),
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  @{PROC_D}/						r,
  @{PROC_D}/@{pids}/cmdline				r,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/bin/service_*				mr,
  
  # READS/WRITES ---------------------------------------
  /run/openrc/scheduled/				r,
  /run/openrc/daemons/{,**}				r,
  /run/**.pid						r,
  
  # DENY INHERIT ---------------------------------------
  deny /apparmor/.null					rw,	# flags=(attach_disconnected)
}

profile openrc.service_set_value@{p_root} /lib{,32,64}/rc/bin/service_set_value@{t_root} flags=(complain) {
  #include <abstractions/base>
  
  # PSEUDO ---------------------------------------------
  /dev/tty						rw,
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/bin/service_set_value			mr,
  
  # READS/WRITES ---------------------------------------
  /run/openrc/options/**				w,
}

profile openrc.service_get_value@{p_root} /lib{,32,64}/rc/bin/service_get_value@{t_root} flags=(attach_disconnected,complain) {
  #include <abstractions/base>
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/bin/service_get_value			mr,
  
  # READS/WRITES ---------------------------------------
  /run/openrc/options/**				r,
  
  # DENY INHERIT ---------------------------------------
  deny /apparmor/.null					rw,	# flags=(attach_disconnected)
}

profile openrc.mark_service_inactive@{p_root} /lib{,32,64}/rc/sbin/mark_service_inactive@{t_root} flags=(complain) {
  #include <abstractions/base>
  
  # SIGNAL ---------------------------------------------
  signal (send) set=(hup) peer="*.init.d@{p_root}",
  
  # PSEUDO ---------------------------------------------
  /dev/tty[0-9]*					rw,
  /dev/console						rw,
  /dev/pts/[0-9]*					rw,
  
  # EXECUTABLES ----------------------------------------
  /lib{,32,64}/rc/sbin/mark_service_inactive		mr,
  
  # READS/WRITES ---------------------------------------
  /run/openrc/inactive/*				w,
  /run/openrc/starting/*				w,
  /run/openrc/exclusive/*				w,
  /run/openrc/stopping/*				w,
}

profile openrc.netmount.init.d@{p_root} /etc/init.d/netmount@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # CAPABILITIES ---------------------------------------
  capability mknod,
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/netmount/tasks		w,
  @{SYS_D}/fs/cgroup/unified/netmount/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/netmount/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /etc/init.d/dnsmasq@{t_root}				Px,
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/mount@{t_root}					Cx,	# sys-apps/util-linux
  /bin/umount@{t_root}					Cx,	# sys-apps/util-linux
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/netmount				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/netmount/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/netmount/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/netmount/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
  
  profile mount /bin/mount@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/pts/[0-9]*					rw,
    
    # MOUNT --------------------------------------------
    
    # EXECUTABLES --------------------------------------
    /bin/mount						mr,
    
    # READS/WRITES -------------------------------------
    /etc/fstab						r,
  }
  
  profile umount /bin/umount@{t_root} {
    #include <abstractions/base>
    
    # MOUNT --------------------------------------------
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    owner @{PROC_D}/@{pid}/mountinfo			r,
    
    # EXECUTABLES --------------------------------------
    /bin/umount						mr,
  }
}

profile openrc.consolefont.init.d@{p_root} /etc/init.d/consolefont@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/consolefont/tasks		w,
  @{SYS_D}/fs/cgroup/unified/consolefont/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/consolefont/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /usr/bin/setfont@{t_root}				Px,	# sys-apps/kbd
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/consolefont			r,
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES ---------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/consolefont/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
    
    # READS/WRITES -------------------------------------
    /lib{,32,64}/rc/console/				w,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/consolefont/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/consolefont/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.local.init.d@{p_root} /etc/init.d/local@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  #include <local/profile_blocks/openrc.local.d/>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/local/tasks			w,
  @{SYS_D}/fs/cgroup/unified/local/cgroup.procs		w,
  @{SYS_D}/fs/cgroup/unified/local/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/local				r,
  /etc/local.d/{,*}					r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/local/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/local/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/local/			w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.hwclock.init.d@{p_root} /etc/init.d/hwclock@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  /dev/							r,
  @{SYS_D}/fs/cgroup/openrc/hwclock/tasks		w,
  @{SYS_D}/fs/cgroup/unified/hwclock/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/hwclock/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/uname@{t_root}					Px,	# sys-apps/coreutils
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /sbin/hwclock@{t_root}				Px,	# sys-apps/util-linux
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/hwclock				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/hwclock/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/hwclock/cgroup.procs	r,
    @{PROC_D}/devices					r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/hwclock/			w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.swap.init.d@{p_root} /etc/init.d/swap@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/swap/tasks			w,
  @{SYS_D}/fs/cgroup/unified/swap/cgroup.procs		w,
  @{SYS_D}/fs/cgroup/unified/swap/cgroup.events		r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /sbin/swapon@{t_root}					Px,	# sys-apps/util-linux
  /sbin/swapoff@{t_root}				Px,	# sys-apps/util-linux
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/swap				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/swap/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/swap/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/swap/			w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.modules.init.d@{p_root} /etc/init.d/modules@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/modules/tasks		w,
  @{SYS_D}/fs/cgroup/unified/modules/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/modules/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/uname@{t_root}					Px,	# sys-apps/coreutils
  /bin/kmod@{t_root}					Px,	# sys-apps/kmod
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/modules				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/modules/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/modules/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/modules/			w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.fsck.init.d@{p_root} /etc/init.d/fsck@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # CAPABILITIES ---------------------------------------
  capability mknod,
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/fsck/tasks			w,
  @{SYS_D}/fs/cgroup/unified/fsck/cgroup.procs		w,
  @{SYS_D}/fs/cgroup/unified/fsck/cgroup.events		r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /etc/init.d/*@{t_root}				Px,
  /bin/cat@{t_root}					Cx,	# sys-apps/coreutils
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /sbin/fsck@{t_root}					Px,	# sys-apps/util-linux
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/fsck				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile cat /bin/cat@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{PROC_D}/cmdline					r,
    
    # EXECUTABLES --------------------------------------
    /bin/cat						mr,
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/fsck/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/fsck/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/fsck/			w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.opentmpfiles-dev.init.d@{p_root} /etc/init.d/opentmpfiles-dev@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/opentmpfiles-dev/tasks	w,
  @{SYS_D}/fs/cgroup/unified/opentmpfiles-dev/cgroup.procs w,
  @{SYS_D}/fs/cgroup/unified/opentmpfiles-dev/cgroup.events r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/tmpfiles@{t_root}				Px,	# sys-apps/opentmpfiles
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/opentmpfiles-dev			r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/opentmpfiles-dev/ w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/opentmpfiles-dev/cgroup.procs r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/opentmpfiles-dev/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.opentmpfiles-setup.init.d@{p_root} /etc/init.d/opentmpfiles-setup@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/opentmpfiles-setup/tasks	w,
  @{SYS_D}/fs/cgroup/unified/opentmpfiles-setup/cgroup.procs w,
  @{SYS_D}/fs/cgroup/unified/opentmpfiles-setup/cgroup.events r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/tmpfiles@{t_root}				Px,	# sys-apps/opentmpfiles
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/opentmpfiles-setup			r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/opentmpfiles-setup/ w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/opentmpfiles-setup/cgroup.procs r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/opentmpfiles-setup/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.root.init.d@{p_root} /etc/init.d/root@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/root/tasks			w,
  @{SYS_D}/fs/cgroup/unified/root/cgroup.procs		w,
  @{SYS_D}/fs/cgroup/unified/root/cgroup.events		r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/rm@{t_root}					Cx,	# sys-apps/coreutils
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/mount@{t_root}					Cx,	# sys-apps/util-linux
  audit /etc/init.d/mtab@{t_root}			Px,	# FIX ME! audit 17.11.2017
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/root				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile rm /bin/rm@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/rm						mr,
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/root/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/root/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/root/			w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
  
  profile mount /bin/mount@{t_root} {
    #include <abstractions/base>
    #include <local/profile_blocks/openrc.root.d/>		# Локальные правила монтирования и размонтирования.
    
    # CAPABILITIES -------------------------------------
    capability sys_admin,
    
    # PSEUDO -------------------------------------------
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/devices/virtual/block/@{BLOCK_VIRT}/{,**}	r,
    audit @{PROC_D}/@{pid}/mounts			r,	# FIX ME! @{pid}/@{pids} audit 19.10.2017
    audit @{PROC_D}/@{pid}/mountinfo			r,	# FIX ME! @{pid}/@{pids} audit 19.10.2017
    
    # EXECUTABLES --------------------------------------
    /bin/mount						mr,
    
    # READS/WRITES -------------------------------------
    /							r,
    /etc/fstab						r,
  }
}

profile openrc.mtab.init.d@{p_root} /etc/init.d/mtab@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/mtab/tasks			w,
  @{SYS_D}/fs/cgroup/unified/mtab/cgroup.procs		w,
  @{SYS_D}/fs/cgroup/unified/mtab/cgroup.events		r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/ln@{t_root}					Cx,	# sys-apps/coreutils
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/mtab				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile ln /bin/ln@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/ln						mr,
    
    # READS/WRITES -------------------------------------
    /etc/mtab						w,
    /etc/@{TMP8}					rw,
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/mtab/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/mtab/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/mtab/			w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.localmount.init.d@{p_root} /etc/init.d/localmount@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/localmount/tasks		w,
  @{SYS_D}/fs/cgroup/unified/localmount/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/localmount/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /etc/init.d/*@{t_root}				Px,
  /bin/sed@{t_root}					Cx,	# sys-apps/sed
  /bin/sync@{t_root}					Px,	# sys-apps/coreutils
  /bin/fuser@{t_root}					Px,	# sys-process/psmisc
  /bin/sleep@{t_root}					Px,	# sys-apps/coreutils
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/mount@{t_root}					Cx,	# sys-apps/util-linux
  /bin/umount@{t_root}					Cx,	# sys-apps/util-linux
  /usr/bin/timeout@{t_root}				Cx,	# sys-apps/coreutils
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/localmount				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile sed /bin/sed@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/sed						mr,
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/localmount/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/localmount/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/localmount/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
  
  profile mount /bin/mount@{t_root} {
    #include <abstractions/base>
    #include <local/profile_blocks/openrc.localmount.d/>	# Локальные правила монтирования и размонтирования.
    
    # CAPABILITIES -------------------------------------
    capability sys_admin,
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/devices/virtual/block/@{BLOCK_VIRT}/{,**}	r,
    @{SYS_D}/devices/pci@{PCI2}/@{PCI4}/{ata@{ATA1},usb@{USB1}}/**/block/@{BLOCK_REAL}/{,**} r,
    owner @{PROC_D}/@{pid}/mountinfo			r,
    
    # EXECUTABLES --------------------------------------
    /bin/mount						mr,
    
    # READS/WRITES -------------------------------------
    /etc/fstab						r,
    /run/mount/						w,
    /run/mount/utab					rw,
    /run/mount/utab.*					rwk,
  }
  
  profile umount /bin/umount@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability sys_admin,
    capability dac_override,
    capability dac_read_search,
    
    # MOUNT --------------------------------------------
    umount,							# Должен отмонтировать все не системные фс.
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    audit @{PROC_D}/@{pid}/mountinfo			r,	# FIX ME! @{pid}/@{pids} audit 19.10.2017
    
    # EXECUTABLES --------------------------------------
    /bin/umount						mr,
    
    # READS/WRITES -------------------------------------
    /run/mount/utab					rw,
  }
  
  profile timeout /usr/bin/timeout@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /usr/bin/timeout					mr,
    /bin/fuser@{t_root}					Px,	# sys-process/psmisc
  }
}

profile openrc.sysctl.init.d@{p_root} /etc/init.d/sysctl@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/sysctl/tasks		w,
  @{SYS_D}/fs/cgroup/unified/sysctl/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/sysctl/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /usr/sbin/sysctl@{t_root}				Px,	# sys-process/procps
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/sysctl				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/sysctl/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/sysctl/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/sysctl/			w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.bootmisc.init.d@{p_root} /etc/init.d/bootmisc@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/bootmisc/tasks		w,
  @{SYS_D}/fs/cgroup/unified/bootmisc/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/bootmisc/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/rm@{t_root}					Cx,	# sys-apps/coreutils
  /bin/readlink@{t_root}				Cx,	# sys-apps/coreutils
  /bin/mktemp@{t_root}					Cx,	# sys-apps/coreutils
  /bin/chgrp@{t_root}					Cx,	# sys-apps/coreutils
  /bin/chmod@{t_root}					Cx,	# sys-apps/coreutils
  /bin/dmesg@{t_root}					Px,	# sys-apps/util-linux
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/mount@{t_root}					Cx,	# sys-apps/util-linux
  /bin/umount@{t_root}					Cx,	# sys-apps/util-linux
  /sbin/halt@{t_root}					Px,	# sys-apps/sysvinit
  /sbin/openrc-shutdown@{t_root}			Px,	# sys-apps/openrc, openrc-init
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/bootmisc				r,
  /run/utmp						w,
  /var/log/dmesg					w,
  /var/log/wtmp						w,
  
  # TEMP -----------------------------------------------
  owner /tmp/tmp.@{TMP10}/run/				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile rm /bin/rm@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/rm						mr,
    
    # READS/WRITES -------------------------------------
    /lib{,32,64}/rc/console/{font,keymap,unicode}	w,
  }
  
  profile readlink /bin/readlink@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/readlink					mr,
  }
  
  profile mktemp /bin/mktemp@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/mktemp						mr,
    
    # TEMP ---------------------------------------------
    owner /tmp/tmp.@{TMP10}/				w,
  }
  
  profile chgrp /bin/chgrp@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    
    # CAPABILITIES -------------------------------------
    capability chown,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/chgrp						mr,
    
    # READS/WRITES -------------------------------------
    /run/utmp						w,
  }
  
  profile chmod /bin/chmod@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability fsetid,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/chmod						mr,
    
    # READS/WRITES -------------------------------------
    /run/utmp						w,
    /var/log/dmesg					w,
    
    # TEMP ---------------------------------------------
    owner /tmp/.ICE-unix/				w,
    owner /tmp/.X11-unix/				w,
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability sys_admin,
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/bootmisc/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
    
    # TEMP ---------------------------------------------
    owner /tmp/.ICE-unix/				w,
    owner /tmp/.X11-unix/				w,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/bootmisc/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/bootmisc/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
    
    # TEMP ---------------------------------------------
    owner /tmp/tmp.@{TMP10}/				w,
  }
  
  profile mount /bin/mount@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability sys_admin,
    
    # MOUNT --------------------------------------------
    mount options=(rw, bind) / -> /tmp/tmp.@{TMP10}/,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/mount						mr,
    
    # READS/WRITES -------------------------------------
    /run/mount/utab					rw,
  }
  
  profile umount /bin/umount@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability sys_admin,
    
    # MOUNT --------------------------------------------
    umount /tmp/tmp.@{TMP10}/,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/umount						mr,
    
    # READS/WRITES -------------------------------------
    /run/mount/utab					rw,
  }
}

profile openrc.hostname.init.d@{p_root} /etc/init.d/hostname@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # CAPABILITIES ---------------------------------------
  capability sys_admin,
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/hostname/tasks		w,
  @{SYS_D}/fs/cgroup/unified/hostname/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/hostname/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/hostname@{t_root}				Px,	# sys-apps/net-tools
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  audit /etc/init.d/syslog-ng@{t_root}			Px,	# app-admin/syslog-ng	# FIX ME! audit 17.11.2017
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/hostname				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/hostname/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/hostname/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/hostname/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.termencoding.init.d@{p_root} /etc/init.d/termencoding@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/termencoding/tasks		w,
  @{SYS_D}/fs/cgroup/unified/termencoding/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/termencoding/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /etc/init.d/keymaps@{t_root}				Px,
  /etc/init.d/consolefont@{t_root}			Px,
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/termencoding			r,
  /lib{,32,64}/rc/console/unicode			w,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
  
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/termencoding/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
    
    # READS/WRITES -------------------------------------
    /lib{,32,64}/rc/console/				w,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/termencoding/cgroup.procs r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/termencoding/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.runsvdir.init.d@{p_root} /etc/init.d/runsvdir@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/runsvdir/tasks		w,
  @{SYS_D}/fs/cgroup/unified/runsvdir/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/runsvdir/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/runsvdir				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/runsvdir/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/runsvdir/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/runsvdir/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.keymaps.init.d@{p_root} /etc/init.d/keymaps@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/keymaps/tasks		w,
  @{SYS_D}/fs/cgroup/unified/keymaps/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/keymaps/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /usr/bin/kbd_mode@{t_root}				Px,	# sys-apps/kbd
  /usr/bin/loadkeys@{t_root}				Px,	# sys-apps/kbd
  /usr/bin/dumpkeys@{t_root}				Px,	# sys-apps/kbd
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/keymaps				r,
  /lib{,32,64}/rc/console/keymap			w,
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/keymaps/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
    
    # READS/WRITES -------------------------------------
    /lib{,32,64}/rc/console/				w,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/keymaps/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/keymaps/			w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.urandom.init.d@{p_root} /etc/init.d/urandom@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # CAPABILITIES ---------------------------------------
  capability mknod,
  
  # PSEUDO ---------------------------------------------
  /dev/urandom						w,
  @{SYS_D}/fs/cgroup/openrc/urandom/tasks		w,
  @{SYS_D}/fs/cgroup/unified/urandom/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/urandom/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/cat@{t_root}					Cx,	# sys-apps/coreutils
  /bin/dd@{t_root}					Cx,	# sys-apps/coreutils
  /bin/rm@{t_root}					Cx,	# sys-apps/coreutils
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/urandom				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile cat /bin/cat@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability mknod,
    
    # PSEUDO -------------------------------------------
    /dev/urandom					w,
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{PROC_D}/sys/kernel/random/poolsize		r,
    
    # EXECUTABLES --------------------------------------
    /bin/cat						mr,
    
    # READS/WRITES -------------------------------------
    /var/lib/misc/random-seed				r,
  }
  
  profile dd /bin/dd@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/dd						mr,
    
    # READS/WRITES -------------------------------------
    /var/lib/misc/random-seed				w,
  }
  
  profile rm /bin/rm@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/rm						mr,
    
    # READS/WRITES -------------------------------------
    /var/lib/misc/random-seed				w,
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/urandom/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/urandom/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/urandom/			w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.loopback.init.d@{p_root} /etc/init.d/loopback@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/loopback/tasks		w,
  @{SYS_D}/fs/cgroup/unified/loopback/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/loopback/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/ip@{t_root}					Px,	# sys-apps/iproute2
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/loopback				r,
  /etc/iproute2/rt_scopes				r,	# sys-apps/iproute2
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/loopback/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/loopback/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/loopback/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.procfs.init.d@{p_root} /etc/init.d/procfs@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/procfs/tasks		w,
  @{SYS_D}/fs/cgroup/unified/procfs/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/procfs/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/procfs				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/procfs/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/procfs/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/procfs/			w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.killprocs.init.d@{p_root} /etc/init.d/killprocs@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # SIGNAL ---------------------------------------------
  signal (receive),						# FIX ME! Не удалось понять, что именно получает. Выполняется
  								# в конце выключения/перезагрузки, даже в тестовом режиме
  								# запуска syslog-ng к этому моменту убивает процесс syslog-ng.
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/killprocs/tasks		w,
  @{SYS_D}/fs/cgroup/unified/killprocs/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/killprocs/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /sbin/killall5@{t_root}				Px,	# sys-apps/sysvinit	# FIX ME! с openrc v0.72 не используется, скрипт изменен на kill_all
  /lib{,32,64}/rc/bin/kill_all@{t_root}			Px,	# sys-apps/openrc, openrc-init
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/killprocs				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/killprocs/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/killprocs/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/killprocs/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.mount-ro.init.d@{p_root} /etc/init.d/mount-ro@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/mount-ro/tasks		w,
  @{SYS_D}/fs/cgroup/unified/mount-ro/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/mount-ro/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/sync@{t_root}					Px,	# sys-apps/coreutils
  /bin/sed@{t_root}					Cx,	# sys-apps/sed
  /bin/fuser@{t_root}					Px,	# sys-process/psmisc
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/umount@{t_root}					Cx,	# sys-apps/util-linux
  /usr/bin/timeout@{t_root}				Cx,	# sys-apps/coreutils
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/mount-ro				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile sed /bin/sed@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/console					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/sed						mr,
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/mount-ro/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/mount-ro/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/mount-ro/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
  
  profile umount /bin/umount@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability sys_admin,
    capability dac_override,
    
    # MOUNT --------------------------------------------
    umount,							# Должен отмонтировать все, что осталось.
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    audit @{PROC_D}/@{pid}/mountinfo			r,	# FIX ME! @{pid}/@{pids} audit 19.10.2017
    
    # EXECUTABLES --------------------------------------
    /bin/umount						mr,
    
    # READS/WRITES -------------------------------------
    /run/mount/utab					rw,
  }
  
  profile timeout /usr/bin/timeout@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /usr/bin/timeout					mr,
    /bin/fuser@{t_root}					Px,	# sys-process/psmisc
  }
}

profile openrc.savecache.init.d@{p_root} /etc/init.d/savecache@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/savecache/tasks		w,
  @{SYS_D}/fs/cgroup/unified/savecache/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/savecache/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/cp@{t_root}					Cx,	# sys-apps/coreutils
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/rm@{t_root}					Cx,	# sys-apps/coreutils
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/savecache				r,
  /lib{,32,64}/rc/cache/*				rw,
  /run/openrc/**					r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile cp /bin/cp@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/console					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/cp						mr,
    
    # READS/WRITES -------------------------------------
    /run/openrc/**					r,
    /lib{,32,64}/rc/cache/**				w,
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/savecache/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/savecache/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/savecache/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
  
  profile rm /bin/rm@{t_root} {
    #include <abstractions/base>
    
    # EXECUTABLES --------------------------------------
    /bin/rm						mr,
    
    # READS/WRITES -------------------------------------
    /lib{,32,64}/rc/cache/{,**}				w,
  }
}

profile openrc.devfs.init.d@{p_root} /etc/init.d/devfs@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # CAPABILITIES ---------------------------------------
  capability mknod,
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/devfs/tasks			w,
  @{SYS_D}/fs/cgroup/unified/devfs/cgroup.procs		w,
  @{SYS_D}/fs/cgroup/unified/devfs/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/mount@{t_root}					Cx,	# sys-apps/util-linux
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/devfs				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    /dev/mqueue/					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/devfs/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/devfs/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/devfs/			w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
  
  profile mount /bin/mount@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability sys_admin,
    
    # MOUNT --------------------------------------------
    mount options=(rw, nosuid, remount) -> /dev/,
    mount fstype=mqueue options=(rw, nosuid, nodev, noexec) mqueue -> /dev/mqueue/,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/mount						mr,
  }
}

profile openrc.dmesg.init.d@{p_root} /etc/init.d/dmesg@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/dmesg/tasks			w,
  @{SYS_D}/fs/cgroup/unified/dmesg/cgroup.procs		w,
  @{SYS_D}/fs/cgroup/unified/dmesg/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/dmesg@{t_root}					Px,	# sys-apps/util-linux
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/dmesg				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/dmesg/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/dmesg/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/dmesg/			w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.kmod-static-nodes.init.d@{p_root} /etc/init.d/kmod-static-nodes@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/kmod-static-nodes/tasks	w,
  @{SYS_D}/fs/cgroup/unified/kmod-static-nodes/cgroup.procs w,
  @{SYS_D}/fs/cgroup/unified/kmod-static-nodes/cgroup.events r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/kmod@{t_root}					Px,	# sys-apps/kmod
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/kmod-static-nodes			r,
  /run/tmpfiles.d/					w,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/kmod-static-nodes/ w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/kmod-static-nodes/cgroup.procs r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/kmod-static-nodes/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.sysfs.init.d@{p_root} /etc/init.d/sysfs@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/*/{,**}				w,
  @{SYS_D}/fs/cgroup/unified/cgroup.controllers		r,
  @{PROC_D}/cgroups					r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/mount@{t_root}					Cx,	# sys-apps/util-linux
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/sysfs				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/						w,
    @{SYS_D}/fs/cgroup/*/				w,
    @{SYS_D}/fs/cgroup/{openrc,unified}/sysfs/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
    
    # DENY INHERIT -------------------------------------
    deny /proc/cgroups					r,	# openrc.sysfs.init.d
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/sysfs/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/sysfs/			w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
  
  profile mount /bin/mount@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability sys_admin,
    capability dac_override,
    
    # MOUNT --------------------------------------------
    mount fstype=securityfs options=(rw, nosuid, nodev, noexec) securityfs -> @{SYS_D}/kernel/security/,
    mount fstype=configfs options=(rw, nosuid, nodev, noexec) configfs -> @{SYS_D}/kernel/config/,
    mount fstype=fusectl options=(rw, nosuid, nodev, noexec) fusectl -> @{SYS_D}/fs/fuse/connections/,
    mount fstype=tmpfs options=(rw, nosuid, nodev, noexec) cgroup_root -> @{SYS_D}/fs/cgroup/,
    mount fstype=cgroup options=(rw, nosuid, nodev, noexec) openrc -> @{SYS_D}/fs/cgroup/openrc/,
    mount fstype=cgroup2 options=(rw, nosuid, nodev, noexec) none -> @{SYS_D}/fs/cgroup/unified/,
    mount fstype=cgroup options=(rw, nosuid, nodev, noexec) cpuset -> @{SYS_D}/fs/cgroup/cpuset/,
    mount fstype=cgroup options=(rw, nosuid, nodev, noexec) cpu -> @{SYS_D}/fs/cgroup/cpu/,
    mount fstype=cgroup options=(rw, nosuid, nodev, noexec) cpuacct -> @{SYS_D}/fs/cgroup/cpuacct/,
    mount fstype=cgroup options=(rw, nosuid, nodev, noexec) freezer -> @{SYS_D}/fs/cgroup/freezer/,
    mount fstype=cgroup options=(rw, nosuid, nodev, noexec) net_cls -> @{SYS_D}/fs/cgroup/net_cls/,
    mount fstype=debugfs options=(rw, nosuid, nodev, noexec) debugfs -> @{SYS_D}/kernel/debug/,
  
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{PROC_D}/cgroups					r,
    
    # EXECUTABLES --------------------------------------
    /bin/mount						mr,
    
    # READS/WRITES -------------------------------------
    /run/mount/						w,
    /run/mount/utab					rw,
  }
}

profile openrc.modules-load.init.d@{p_root} /etc/init.d/modules-load@{t_root} flags=(attach_disconnected) {	# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/modules-load/tasks		w,
  @{SYS_D}/fs/cgroup/unified/modules-load/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/modules-load/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/kmod@{t_root}					Px,	# sys-apps/kmod
  /bin/sort@{t_root}					Cx,	# sys-apps/coreutils
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  
  # READS/WRITES ---------------------------------------
  /etc/{conf,init}.d/modules-load			r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile sort /bin/sort@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    
    # EXECUTABLES --------------------------------------
    /bin/sort						mr,
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/modules-load/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/modules-load/cgroup.procs r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/modules-load/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
}

profile openrc.agetty.init.d@{p_root} /etc/init.d/agetty@{t_root} flags=(attach_disconnected,complain) {	# FIX ME! flags=(complain), проверить в работе!
  											# attach_disconnected, name="" comm="start-stop-daem"
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/openrc>
  
  # PSEUDO ---------------------------------------------
  @{SYS_D}/fs/cgroup/openrc/agetty.*/tasks		w,
  @{SYS_D}/fs/cgroup/unified/agetty.*/cgroup.procs	w,
  @{SYS_D}/fs/cgroup/unified/agetty.*/cgroup.events	r,
  
  # EXECUTABLES ----------------------------------------
  @{shell}@{t_root}					Cx,
  /bin/mkdir@{t_root}					Cx,	# sys-apps/coreutils
  /bin/grep@{t_root}					Cx,	# sys-apps/grep
  /bin/rmdir@{t_root}					Cx,	# sys-apps/coreutils
  /sbin/supervise-daemon@{t_root}			Cx,
  
  # READS/WRITES ---------------------------------------
  /etc/init.d/agetty					r,
  /etc/conf.d/agetty{,.*}				r,
  
  profile shell @{shell}@{t_root} {
    #include <abstractions/base>
    #include <abstractions/nameservice>
    #include <abstractions/openrc-shell>
  }
  
  profile mkdir /bin/mkdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/{openrc,unified}/agetty.*/	w,
    
    # EXECUTABLES --------------------------------------
    /bin/mkdir						mr,
  }
  
  profile grep /bin/grep@{t_root} {
    #include <abstractions/base>
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/agetty.*/cgroup.procs	r,
    
    # EXECUTABLES --------------------------------------
    /bin/grep						mr,
  }
  
  profile rmdir /bin/rmdir@{t_root} {
    #include <abstractions/base>
    
    # CAPABILITIES -------------------------------------
    capability dac_override,
    
    # PSEUDO -------------------------------------------
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
    @{SYS_D}/fs/cgroup/unified/agetty.*/		w,
    
    # EXECUTABLES --------------------------------------
    /bin/rmdir						mr,
  }
  
  profile supervise-daemon /sbin/supervise-daemon@{t_root} flags=(complain) {	# FIX ME! flags=(complain), проверить в работе!
    #include <abstractions/base>
    #include <abstractions/nameservice>
    
    # SIGNAL -------------------------------------------
    signal (send) set=(term) peer="util-linux.agetty@{p_root}",
    
    # PSEUDO -------------------------------------------
    /dev/tty						rw,
    /dev/tty[0-9]*					rw,
    /dev/console					rw,
    /dev/pts/[0-9]*					rw,
  
    # EXECUTABLES --------------------------------------
    /sbin/supervise-daemon				mr,
    /sbin/agetty@{t_root}				Px,	# sys-apps/util-linux
  
    # READS/WRITES -------------------------------------
    /run/agetty.*.pid					rw,
    /run/openrc/daemons/agetty.*/{,**}			rw,
    /run/openrc/options/agetty.*/{,**}			rw,
    /run/openrc/scheduled/				r,
    /run/openrc/stopping/agetty.*			w,
    /run/openrc/exclusive/agetty.*			w,
  }
}
