# ------------------------------------------------------------------
#
#    Copyright (C) 2016 Mikhail Kurinnoi
#
#    This program is free software; you can redistribute it and/or
#    modify it under the terms of version 2 of the GNU General Public
#    License published by the Free Software Foundation.
#
# ------------------------------------------------------------------

#include <tunables/global>
profile dhcpcd /sbin/dhcpcd {
  #include <abstractions/base>
  #include <abstractions/nameservice>

  capability net_raw,
  capability net_admin,
  capability sys_admin,
  capability sys_tty_config,
  capability net_bind_service,

  /dev/tty rw,
  /dev/console rw,

  /bin/bash rmix,
  /bin/touch rmix,
  /bin/mkdir rmix,
  /bin/rm rmix,
  /bin/sed rmix,
  /usr/bin/cmp rmix,
  /bin/cat rmix,
  /bin/chmod rmix,
  /bin/hostname rmix,
  /sbin/dhcpcd rmix,
  /sbin/modify_resolvconf rmix,
  /lib64/dhcpcd/dhcpcd-run-hooks rmix,
  
  /etc/resolv.conf{,.sv} rwl,
  /etc/ntp.conf{,.sv} rwl,
  /etc/dhcpcd.conf r,
  /etc/dhcpcd.duid rw,
  /proc/sys/net/ipv4/conf/*/promote_secondaries rwk,
  /run/dhcpcd/ wr,
  /run/dhcpcd/resolv.conf/ rw,
  /run/dhcpcd/resolv.conf/* rw,
  /run/dhcpcd/resolv.conf.*.dhcp rw,
  /run/dhcpcd/ntp.conf/ rw,
  /run/dhcpcd/ntp.conf.*.dhcp rwk,
  /var/lib/dhcpcd/dhcpcd-*.cache rw,
  /var/lib/dhcpcd/dhcpcd-*.info rw,
  /var/lib/dhcpcd/dhcpcd-*.info.old rw,
  /{,var/}run/dhcpcd-*.pid rwlk,
  /var/lib/dhcpcd/dhcpcd-*.lease rwk,
  
}
